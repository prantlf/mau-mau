"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{"default":e}}function _toConsumableArray(e){if(Array.isArray(e)){for(var r=0,a=Array(e.length);r<e.length;r++)a[r]=e[r];return a}return Array.from(e)}function getComputer(){return smartComputer=!smartComputer,smartComputer?new _SmartComputer2["default"]:new _DummyComputer2["default"]}Object.defineProperty(exports,"__esModule",{value:!0});var _Game=require("../engine/game/Game"),_Game2=_interopRequireDefault(_Game),_Human=require("../engine/players/Human"),_Human2=_interopRequireDefault(_Human),_DummyComputer=require("../engine/players/DummyComputer"),_DummyComputer2=_interopRequireDefault(_DummyComputer),_SmartComputer=require("../engine/players/SmartComputer"),_SmartComputer2=_interopRequireDefault(_SmartComputer),_Reporter=require("../engine/misc/Reporter"),_Reporter2=_interopRequireDefault(_Reporter),_ConsoleTracer=require("./console/ConsoleTracer"),_ConsoleTracer2=_interopRequireDefault(_ConsoleTracer),_ConsolePrompt=require("./console/ConsolePrompt"),_ConsolePrompt2=_interopRequireDefault(_ConsolePrompt),_i18n=require("../engine/misc/i18n"),_i18n2=_interopRequireDefault(_i18n),commander=require("commander").version("0.1.0").description("Starts a new mau-mau card game, interacting on the console.\n  Index of the winning player is returned as the program exit code.").usage("[option]").option("-p, --players <integer|list>","Player count (4 by default) or player list","4").option("-m, --human <integer>","Index of the human player (none by default)",parseInt).option("-s, --silent","No console output (false by default)").option("-l, --language <locale>","Translation of texts (env.LANG by default)").on("--help",function(){console.log("  Player list is a comma-delimited list of player implementations:"),console.log('  "human", "smart" and "dummy" identifiers are available.  The default'),console.log('  player list is "smart,dummy,smart,dummy".')}).parse(process.argv),locale=/^[a-zA-Z]+/.exec(commander.language||process.env.LANG||"en");if(locale){var translations=_i18n2["default"].getTranslations();locale=locale[0],translations.seven[locale]&&_i18n2["default"].setLocale(locale)}var players=parseInt(commander.players,10);isNaN(players)?players=commander.players.split(",").map(function(e){return e=e.trim().toLowerCase(),"human"===e?new _Human2["default"]:"smart"===e?new _SmartComputer2["default"]:"dummy"===e?new _DummyComputer2["default"]:(console.log("Invalid player."),void process.exit(-1))}):(2>players&&(console.log("Two players are the minimum."),process.exit(-1)),(commander.human<1||commander.human>players)&&(console.log("Index of the human player out of the player count."),process.exit(-1)),players=[].concat(_toConsumableArray(Array(players).keys())).map(function(e){return e+1===commander.human?new _Human2["default"]:getComputer()}));var smartComputer,prompt=new _ConsolePrompt2["default"],game=new _Game2["default"]({players:players,prompt:prompt});commander.silent||new _ConsoleTracer2["default"](new _Reporter2["default"](game)),game.on("game:finished",function(e){process.exit(game.players.indexOf(e)+1)}),exports["default"]=game.start.bind(game);
//# sourceMappingURL=play.js.map
